{"ast":null,"code":"import _objectSpread from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{withRouter}from'react-router-dom';import{Button,Card,Table,Tag,Space,message}from'antd';import{PlusOutlined}from'@ant-design/icons';import{connect}from'react-redux';import{getSubmittedRequests}from'../../api';import{Link}from'react-router-dom';import{cachePageNum}from'../../redux/actions/page';import{unCacheUser}from'../../redux/actions/user';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Column=Table.Column;var RequestCheck=/*#__PURE__*/function(_Component){_inherits(RequestCheck,_Component);var _super=_createSuper(RequestCheck);function RequestCheck(){var _this;_classCallCheck(this,RequestCheck);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={submittedRequests:[],loading:false};_this.fetchSubmittedRequests=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(type){var response,submittedRequests;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({loading:true});_context.next=3;return getSubmittedRequests(type);case 3:response=_context.sent;if(response.code===0){submittedRequests=response.data;_this.setState({submittedRequests:submittedRequests,loading:false});}else if(response.code===405){_this.props.unCacheUser();_this.props.history.replace('/launch');}else{message.error(response.msg);}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(RequestCheck,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchSubmittedRequests(this.requestType);}},{key:\"render\",value:function render(){var _this2=this;var _ref2=this.props.location.state||{},requestType=_ref2.requestType;this.requestType=requestType;var title=this.requestType==='global'?'Check Global International Mobility Proxy Forms':'Check Domestic Mobility Proxy Forms';var submitPathName=this.requestType==='global'?'/dashboard/gi-submit':'dashboard/do-submit';var detailPathName=this.requestType==='global'?'dashboard/gi-submit':'dashboard/do-submit';var extra=/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusOutlined,{}),onClick:function onClick(){return _this2.props.history.push({pathname:_this2.submitPathName,state:{requestType:_this2.requestType}});},children:\"Add\"});return/*#__PURE__*/_jsx(Card,{title:title,extra:extra,children:/*#__PURE__*/_jsxs(Table,{dataSource:this.state.submittedRequests,bordered:true,pagination:{defaultPageSize:4,showQuickJumper:true,current:this.props.pageNum,onChange:function onChange(current){return _this2.props.cachePageNum(current);}},loading:this.state.loading,children:[/*#__PURE__*/_jsx(Column,{title:\"File Name\",dataIndex:\"fileName\",render:function render(fileName,record){return/*#__PURE__*/_jsx(\"a\",{href:record.url,children:fileName});}},\"fileName\"),/*#__PURE__*/_jsx(Column,{title:\"Requester\",dataIndex:\"requester\"},\"requester\"),/*#__PURE__*/_jsx(Column,{title:\"Submit Date\",dataIndex:\"submitDate\"},\"submitDate\"),/*#__PURE__*/_jsx(Column,{title:\"Comment\",dataIndex:\"comment\"},\"comment\"),/*#__PURE__*/_jsx(Column,{title:\"Status\",dataIndex:\"tags\",render:function render(tags){return/*#__PURE__*/_jsx(_Fragment,{children:tags.map(function(tag){var color=\"blue\";return/*#__PURE__*/_jsx(Tag,{color:color,children:tag},tag);})});}},\"tags\"),/*#__PURE__*/_jsx(Column,{title:\"Action\",render:function render(text,record){return/*#__PURE__*/_jsx(Space,{size:\"middle\",children:/*#__PURE__*/_jsx(Link,{to:{pathname:\"/dashboard/gi-request-detail\",state:_objectSpread({},record)},children:\"Details\"})});}},\"action\")]})});}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(nextProps,prevState){this.fetchSubmittedRequests(this.requestType);return null;}}]);return RequestCheck;}(Component);export default connect(function(state){return{pageNum:state.pageNum};},{cachePageNum:cachePageNum,unCacheUser:unCacheUser})(withRouter(RequestCheck));","map":{"version":3,"sources":["C:/Users/TaoHu/Desktop/前端/workspace/react-admin-client/src/containers/DashboardContent/RequestCheck.jsx"],"names":["React","Component","withRouter","Button","Card","Table","Tag","Space","message","PlusOutlined","connect","getSubmittedRequests","Link","cachePageNum","unCacheUser","Column","RequestCheck","state","submittedRequests","loading","fetchSubmittedRequests","type","setState","response","code","data","props","history","replace","error","msg","requestType","location","title","submitPathName","detailPathName","extra","push","pathname","defaultPageSize","showQuickJumper","current","pageNum","onChange","fileName","record","url","tags","map","tag","color","text","nextProps","prevState"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { withRouter } from 'react-router-dom'\r\nimport { Button, Card, Table, Tag, Space, message } from 'antd'\r\nimport { PlusOutlined } from '@ant-design/icons';\r\nimport { connect } from 'react-redux';\r\nimport {getSubmittedRequests} from '../../api'\r\nimport {Link} from 'react-router-dom'\r\nimport {cachePageNum} from '../../redux/actions/page'\r\nimport { unCacheUser } from '../../redux/actions/user'\r\n\r\nconst { Column } = Table;\r\n\r\nclass RequestCheck extends Component {\r\n    state = {submittedRequests:[],loading:false}\r\n\r\n    fetchSubmittedRequests = async (type) => {\r\n        this.setState({loading:true})\r\n        let response = await getSubmittedRequests(type)\r\n        if(response.code === 0){\r\n            let submittedRequests = response.data\r\n            this.setState({submittedRequests,loading:false})\r\n        }else if(response.code === 405){\r\n            this.props.unCacheUser()\r\n            this.props.history.replace('/launch')   \r\n        }else{\r\n            message.error(response.msg)\r\n        }\r\n    }\r\n\r\n    componentDidMount(){\r\n        this.fetchSubmittedRequests(this.requestType)\r\n    }\r\n\r\n    static getDerivedStateFromProps(nextProps, prevState) {\r\n        this.fetchSubmittedRequests(this.requestType)\r\n        return null;\r\n    }\r\n\r\n    render() {\r\n        let {requestType} = this.props.location.state || {}\r\n        this.requestType = requestType\r\n\r\n        const title = this.requestType === 'global' ? \r\n                                           'Check Global International Mobility Proxy Forms' :\r\n                                           'Check Domestic Mobility Proxy Forms';\r\n\r\n        const submitPathName = this.requestType === 'global' ? '/dashboard/gi-submit' : 'dashboard/do-submit';\r\n        const detailPathName = this.requestType === 'global' ? 'dashboard/gi-submit' : 'dashboard/do-submit';\r\n        const extra = (<Button type=\"primary\" icon={<PlusOutlined />} onClick={() => this.props.history.push({pathname:this.submitPathName,state:{requestType:this.requestType}})}>Add</Button>)\r\n\r\n        return (\r\n            <Card title={title} extra={extra}>\r\n                <Table \r\n                    dataSource={this.state.submittedRequests} \r\n                    bordered \r\n                    pagination={{defaultPageSize:4, showQuickJumper: true, current:this.props.pageNum, onChange:(current)=>this.props.cachePageNum(current)}} \r\n                    loading={this.state.loading} \r\n                >\r\n                    <Column \r\n                        title=\"File Name\" \r\n                        dataIndex=\"fileName\" \r\n                        key=\"fileName\" \r\n                        render = {(fileName, record) => {\r\n                            return <a href={record.url}>{fileName}</a>    \r\n                        }}\r\n                    />\r\n                    <Column title=\"Requester\" dataIndex=\"requester\" key=\"requester\" />\r\n                    <Column title=\"Submit Date\" dataIndex=\"submitDate\" key=\"submitDate\" />\r\n                    <Column title=\"Comment\" dataIndex=\"comment\" key=\"comment\" />\r\n                    <Column\r\n                        title=\"Status\"\r\n                        dataIndex=\"tags\"\r\n                        key=\"tags\"\r\n                        render={tags => (\r\n                            <>\r\n                                {tags.map(tag => {\r\n                                    let color = \"blue\"\r\n                                    return (\r\n                                        <Tag color={color} key={tag}>\r\n                                            {tag}\r\n                                        </Tag>\r\n                                    )\r\n                                })}\r\n                            </>\r\n                        )}\r\n                    />\r\n                    <Column\r\n                        title=\"Action\"\r\n                        key=\"action\"\r\n                        render={(text, record) => (\r\n                            <Space size=\"middle\">\r\n                                <Link to={{pathname:\"/dashboard/gi-request-detail\",state:{...record}}}>Details</Link>\r\n                            </Space>\r\n                        )}\r\n                    />\r\n                </Table>\r\n            </Card>\r\n        )\r\n    }\r\n}\r\n\r\nexport default connect(\r\n    state => ({pageNum:state.pageNum}),\r\n    {cachePageNum, unCacheUser}\r\n)(withRouter(RequestCheck))\r\n"]},"metadata":{},"sourceType":"module"}