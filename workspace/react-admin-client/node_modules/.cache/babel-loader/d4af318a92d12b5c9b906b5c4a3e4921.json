{"ast":null,"code":"import _objectSpread from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/TaoHu/Desktop/\\u524D\\u7AEF/workspace/react-admin-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{withRouter}from'react-router-dom';import{Button,Card,Table,Tag,Space,message,Modal}from'antd';import{PlusOutlined,ExclamationCircleOutlined}from'@ant-design/icons';import{connect}from'react-redux';import{getSubmittedRequests,deleteSubmittedRequest}from'../../api';import{Link}from'react-router-dom';import{cachePageNum}from'../../redux/actions/page';import{unCacheUser}from'../../redux/actions/user';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Column=Table.Column;var confirm=Modal.confirm;var RequestCheck=/*#__PURE__*/function(_Component){_inherits(RequestCheck,_Component);var _super=_createSuper(RequestCheck);function RequestCheck(){var _this;_classCallCheck(this,RequestCheck);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={submittedRequests:[],loading:false};_this.fetchSubmittedRequests=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(type){var response,submittedRequests;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({loading:true});_context.next=3;return getSubmittedRequests(type);case 3:response=_context.sent;if(response.code===0){submittedRequests=response.data;_this.setState({submittedRequests:submittedRequests,loading:false});}else if(response.code===405){_this.props.unCacheUser();_this.props.history.replace('/launch');}else{message.error(response.msg);_this.setState({loading:false});}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.deleteRequest=function(record){confirm({title:'Do you Want to delete this request?',icon:/*#__PURE__*/_jsx(ExclamationCircleOutlined,{}),content:'',onOk:function(){var _onOk=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,submittedRequests;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this.setState({loading:true});_context2.next=3;return deleteSubmittedRequest(record);case 3:response=_context2.sent;if(response.code===0){submittedRequests=response.data;_this.setState({submittedRequests:submittedRequests,loading:false});message.success('Record is deleted successfully');}else if(response.code===405){_this.props.unCacheUser();_this.props.history.replace('/launch');}else{message.error(response.msg);_this.setState({loading:false});}case 5:case\"end\":return _context2.stop();}}},_callee2);}));function onOk(){return _onOk.apply(this,arguments);}return onOk;}(),onCancel:function onCancel(){}});};return _this;}_createClass(RequestCheck,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchSubmittedRequests(this.requestType);}},{key:\"render\",value:function render(){var _this2=this;var _ref2=this.props.location.state||{},requestType=_ref2.requestType;this.requestType=requestType;var title=this.requestType==='global_mobility'?'Check Global-International Mobility Proxy Forms':this.requestType==='domestic_mobility'?'Check Domestic Mobility Proxy Forms':'Check Proxy Forms';var submitPathName=this.requestType==='global_mobility'?'/dashboard/gi-submit':this.requestType==='domestic_mobility'?'/dashboard/do-submit':'/dashbard/xx-submit';var detailPathName=this.requestType==='global_mobility'?'/dashboard/gi-request-detail':this.requestType==='domestic_mobility'?'/dashboard/do-request-detail':'/dashboard/xx-request-detail';var extra=/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusOutlined,{}),onClick:function onClick(){return _this2.props.history.push({pathname:submitPathName,state:{requestType:_this2.requestType}});},children:\"Add\"});return/*#__PURE__*/_jsx(Card,{title:title,extra:extra,children:/*#__PURE__*/_jsxs(Table,{dataSource:this.state.submittedRequests,bordered:true,pagination:{defaultPageSize:4,showQuickJumper:true,current:this.props.pageNum,onChange:function onChange(current){return _this2.props.cachePageNum(current);}},loading:this.state.loading,children:[/*#__PURE__*/_jsx(Column,{title:\"File Name\",dataIndex:\"attachmentUrl\",render:function render(attachmentUrl,record){return/*#__PURE__*/_jsx(\"a\",{href:attachmentUrl,children:record.attachmentFileName});}},\"attachmentUrl\"),/*#__PURE__*/_jsx(Column,{title:\"Requester\",dataIndex:\"requester\"},\"requester\"),/*#__PURE__*/_jsx(Column,{title:\"Submit Date\",dataIndex:\"submitDate\"},\"submitDate\"),/*#__PURE__*/_jsx(Column,{title:\"Comment\",dataIndex:\"comment\"},\"comment\"),/*#__PURE__*/_jsx(Column,{title:\"Status\",dataIndex:\"tags\",render:function render(tags){return/*#__PURE__*/_jsx(_Fragment,{children:tags.map(function(tag){var color=\"blue\";return/*#__PURE__*/_jsx(Tag,{color:color,children:tag},tag);})});}},\"tags\"),/*#__PURE__*/_jsx(Column,{title:\"Action\",render:function render(text,record){return/*#__PURE__*/_jsxs(Space,{size:\"middle\",children:[/*#__PURE__*/_jsx(Link,{to:{pathname:detailPathName,state:_objectSpread(_objectSpread({},record),{},{requestType:_this2.requestType})},children:\"Details\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return _this2.deleteRequest(record);},type:\"link\",children:\"Delete\"})]});}},\"action\")]})});}}]);return RequestCheck;}(Component);export default connect(function(state){return{pageNum:state.pageNum};},{cachePageNum:cachePageNum,unCacheUser:unCacheUser})(withRouter(RequestCheck));","map":{"version":3,"sources":["C:/Users/TaoHu/Desktop/前端/workspace/react-admin-client/src/containers/DashboardContent/RequestCheck.jsx"],"names":["React","Component","withRouter","Button","Card","Table","Tag","Space","message","Modal","PlusOutlined","ExclamationCircleOutlined","connect","getSubmittedRequests","deleteSubmittedRequest","Link","cachePageNum","unCacheUser","Column","confirm","RequestCheck","state","submittedRequests","loading","fetchSubmittedRequests","type","setState","response","code","data","props","history","replace","error","msg","deleteRequest","record","title","icon","content","onOk","success","onCancel","requestType","location","submitPathName","detailPathName","extra","push","pathname","defaultPageSize","showQuickJumper","current","pageNum","onChange","attachmentUrl","attachmentFileName","tags","map","tag","color","text"],"mappings":"6uCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,MAAT,CAAiBC,IAAjB,CAAuBC,KAAvB,CAA8BC,GAA9B,CAAmCC,KAAnC,CAA0CC,OAA1C,CAAmDC,KAAnD,KAAgE,MAAhE,CACA,OAASC,YAAT,CAAuBC,yBAAvB,KAAwD,mBAAxD,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,OAASC,oBAAT,CAA+BC,sBAA/B,KAA6D,WAA7D,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,YAAT,KAA6B,0BAA7B,CACA,OAASC,WAAT,KAA4B,0BAA5B,C,gJAEQC,CAAAA,M,CAAWb,K,CAAXa,M,IACAC,CAAAA,O,CAAYV,K,CAAZU,O,IAEFC,CAAAA,Y,mVACFC,K,CAAQ,CAAEC,iBAAiB,CAAE,EAArB,CAAyBC,OAAO,CAAE,KAAlC,C,OAERC,sB,0FAAyB,iBAAOC,IAAP,iJACrB,MAAKC,QAAL,CAAc,CAAEH,OAAO,CAAE,IAAX,CAAd,EADqB,sBAEAV,CAAAA,oBAAoB,CAACY,IAAD,CAFpB,QAEjBE,QAFiB,eAGrB,GAAIA,QAAQ,CAACC,IAAT,GAAkB,CAAtB,CAAyB,CACjBN,iBADiB,CACGK,QAAQ,CAACE,IADZ,CAErB,MAAKH,QAAL,CAAc,CAAEJ,iBAAiB,CAAjBA,iBAAF,CAAqBC,OAAO,CAAE,KAA9B,CAAd,EACH,CAHD,IAGO,IAAII,QAAQ,CAACC,IAAT,GAAkB,GAAtB,CAA2B,CAC9B,MAAKE,KAAL,CAAWb,WAAX,GACA,MAAKa,KAAL,CAAWC,OAAX,CAAmBC,OAAnB,CAA2B,SAA3B,EACH,CAHM,IAGA,CACHxB,OAAO,CAACyB,KAAR,CAAcN,QAAQ,CAACO,GAAvB,EACA,MAAKR,QAAL,CAAc,CAAEH,OAAO,CAAE,KAAX,CAAd,EACH,CAZoB,sD,qEAezBY,a,CAAgB,SAACC,MAAD,CAAY,CACxBjB,OAAO,CAAC,CACJkB,KAAK,CAAE,qCADH,CAEJC,IAAI,cAAE,KAAC,yBAAD,IAFF,CAGJC,OAAO,CAAE,EAHL,CAIJC,IAAI,8EAAE,uKACF,MAAKd,QAAL,CAAc,CAAEH,OAAO,CAAE,IAAX,CAAd,EADE,uBAEmBT,CAAAA,sBAAsB,CAACsB,MAAD,CAFzC,QAEET,QAFF,gBAGF,GAAIA,QAAQ,CAACC,IAAT,GAAkB,CAAtB,CAAyB,CACjBN,iBADiB,CACGK,QAAQ,CAACE,IADZ,CAErB,MAAKH,QAAL,CAAc,CAAEJ,iBAAiB,CAAjBA,iBAAF,CAAqBC,OAAO,CAAE,KAA9B,CAAd,EACAf,OAAO,CAACiC,OAAR,CAAgB,gCAAhB,EACH,CAJD,IAIO,IAAId,QAAQ,CAACC,IAAT,GAAkB,GAAtB,CAA2B,CAC9B,MAAKE,KAAL,CAAWb,WAAX,GACA,MAAKa,KAAL,CAAWC,OAAX,CAAmBC,OAAnB,CAA2B,SAA3B,EACH,CAHM,IAGA,CACHxB,OAAO,CAACyB,KAAR,CAAcN,QAAQ,CAACO,GAAvB,EACA,MAAKR,QAAL,CAAc,CAAEH,OAAO,CAAE,KAAX,CAAd,EACH,CAbC,wDAAF,sEAJA,CAmBJmB,QAnBI,oBAmBO,CACV,CApBG,CAAD,CAAP,CAsBH,C,yEAED,4BAAoB,CAChB,KAAKlB,sBAAL,CAA4B,KAAKmB,WAAjC,EACH,C,sBAED,iBAAS,2BACiB,KAAKb,KAAL,CAAWc,QAAX,CAAoBvB,KAApB,EAA6B,EAD9C,CACCsB,WADD,OACCA,WADD,CAEL,KAAKA,WAAL,CAAmBA,WAAnB,CAEA,GAAMN,CAAAA,KAAK,CAAG,KAAKM,WAAL,GAAqB,iBAArB,CAAyC,iDAAzC,CACV,KAAKA,WAAL,GAAqB,mBAArB,CAA2C,qCAA3C,CACI,mBAFR,CAIA,GAAME,CAAAA,cAAc,CAAG,KAAKF,WAAL,GAAqB,iBAArB,CAAyC,sBAAzC,CACnB,KAAKA,WAAL,GAAqB,mBAArB,CAA2C,sBAA3C,CACI,qBAFR,CAIA,GAAMG,CAAAA,cAAc,CAAG,KAAKH,WAAL,GAAqB,iBAArB,CAAyC,8BAAzC,CACnB,KAAKA,WAAL,GAAqB,mBAArB,CAA2C,8BAA3C,CACI,8BAFR,CAIA,GAAMI,CAAAA,KAAK,cAAI,KAAC,MAAD,EAAQ,IAAI,CAAC,SAAb,CAAuB,IAAI,cAAE,KAAC,YAAD,IAA7B,CAA+C,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACjB,KAAL,CAAWC,OAAX,CAAmBiB,IAAnB,CAAwB,CAAEC,QAAQ,CAAEJ,cAAZ,CAA4BxB,KAAK,CAAE,CAAEsB,WAAW,CAAE,MAAI,CAACA,WAApB,CAAnC,CAAxB,CAAN,EAAxD,iBAAf,CAEA,mBACI,KAAC,IAAD,EAAM,KAAK,CAAEN,KAAb,CAAoB,KAAK,CAAEU,KAA3B,uBACI,MAAC,KAAD,EACI,UAAU,CAAE,KAAK1B,KAAL,CAAWC,iBAD3B,CAEI,QAAQ,KAFZ,CAGI,UAAU,CAAE,CAAE4B,eAAe,CAAE,CAAnB,CAAsBC,eAAe,CAAE,IAAvC,CAA6CC,OAAO,CAAE,KAAKtB,KAAL,CAAWuB,OAAjE,CAA0EC,QAAQ,CAAE,kBAACF,OAAD,QAAa,CAAA,MAAI,CAACtB,KAAL,CAAWd,YAAX,CAAwBoC,OAAxB,CAAb,EAApF,CAHhB,CAII,OAAO,CAAE,KAAK/B,KAAL,CAAWE,OAJxB,wBAMI,KAAC,MAAD,EACI,KAAK,CAAC,WADV,CAEI,SAAS,CAAC,eAFd,CAII,MAAM,CAAE,gBAACgC,aAAD,CAAgBnB,MAAhB,CAA2B,CAC/B,mBAAO,UAAG,IAAI,CAAEmB,aAAT,UAAyBnB,MAAM,CAACoB,kBAAhC,EAAP,CACH,CANL,EAGQ,eAHR,CANJ,cAcI,KAAC,MAAD,EAAQ,KAAK,CAAC,WAAd,CAA0B,SAAS,CAAC,WAApC,EAAoD,WAApD,CAdJ,cAeI,KAAC,MAAD,EAAQ,KAAK,CAAC,aAAd,CAA4B,SAAS,CAAC,YAAtC,EAAuD,YAAvD,CAfJ,cAgBI,KAAC,MAAD,EAAQ,KAAK,CAAC,SAAd,CAAwB,SAAS,CAAC,SAAlC,EAAgD,SAAhD,CAhBJ,cAiBI,KAAC,MAAD,EACI,KAAK,CAAC,QADV,CAEI,SAAS,CAAC,MAFd,CAII,MAAM,CAAE,gBAAAC,IAAI,qBACR,yBACKA,IAAI,CAACC,GAAL,CAAS,SAAAC,GAAG,CAAI,CACb,GAAIC,CAAAA,KAAK,CAAG,MAAZ,CACA,mBACI,KAAC,GAAD,EAAK,KAAK,CAAEA,KAAZ,UACKD,GADL,EAAwBA,GAAxB,CADJ,CAKH,CAPA,CADL,EADQ,EAJhB,EAGQ,MAHR,CAjBJ,cAkCI,KAAC,MAAD,EACI,KAAK,CAAC,QADV,CAGI,MAAM,CAAE,gBAACE,IAAD,CAAOzB,MAAP,qBACJ,MAAC,KAAD,EAAO,IAAI,CAAC,QAAZ,wBACI,KAAC,IAAD,EAAM,EAAE,CAAE,CAAEa,QAAQ,CAAEH,cAAZ,CAA4BzB,KAAK,gCAAOe,MAAP,MAAeO,WAAW,CAAE,MAAI,CAACA,WAAjC,EAAjC,CAAV,qBADJ,cAEI,KAAC,MAAD,EAAQ,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACR,aAAL,CAAmBC,MAAnB,CAAN,EAAjB,CAAmD,IAAI,CAAC,MAAxD,oBAFJ,GADI,EAHZ,EAEQ,QAFR,CAlCJ,GADJ,EADJ,CAiDH,C,0BAlHsBnC,S,EAqH3B,cAAeW,CAAAA,OAAO,CAClB,SAAAS,KAAK,QAAK,CAAEgC,OAAO,CAAEhC,KAAK,CAACgC,OAAjB,CAAL,EADa,CAElB,CAAErC,YAAY,CAAZA,YAAF,CAAgBC,WAAW,CAAXA,WAAhB,CAFkB,CAAP,CAGbf,UAAU,CAACkB,YAAD,CAHG,CAAf","sourcesContent":["import React, { Component } from 'react'\r\nimport { withRouter } from 'react-router-dom'\r\nimport { Button, Card, Table, Tag, Space, message, Modal } from 'antd'\r\nimport { PlusOutlined, ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport { connect } from 'react-redux';\r\nimport { getSubmittedRequests, deleteSubmittedRequest } from '../../api'\r\nimport { Link } from 'react-router-dom'\r\nimport { cachePageNum } from '../../redux/actions/page'\r\nimport { unCacheUser } from '../../redux/actions/user'\r\n\r\nconst { Column } = Table;\r\nconst { confirm } = Modal;\r\n\r\nclass RequestCheck extends Component {\r\n    state = { submittedRequests: [], loading: false }\r\n\r\n    fetchSubmittedRequests = async (type) => {\r\n        this.setState({ loading: true })\r\n        let response = await getSubmittedRequests(type)\r\n        if (response.code === 0) {\r\n            let submittedRequests = response.data\r\n            this.setState({ submittedRequests, loading: false })\r\n        } else if (response.code === 405) {\r\n            this.props.unCacheUser()\r\n            this.props.history.replace('/launch')\r\n        } else {\r\n            message.error(response.msg)\r\n            this.setState({ loading: false })\r\n        }\r\n    }\r\n\r\n    deleteRequest = (record) => {\r\n        confirm({\r\n            title: 'Do you Want to delete this request?',\r\n            icon: <ExclamationCircleOutlined />,\r\n            content: '',\r\n            onOk: async () => {\r\n                this.setState({ loading: true })\r\n                let response = await deleteSubmittedRequest(record)\r\n                if (response.code === 0) {\r\n                    let submittedRequests = response.data\r\n                    this.setState({ submittedRequests, loading: false })\r\n                    message.success('Record is deleted successfully')\r\n                } else if (response.code === 405) {\r\n                    this.props.unCacheUser()\r\n                    this.props.history.replace('/launch')\r\n                } else {\r\n                    message.error(response.msg)\r\n                    this.setState({ loading: false })\r\n                }\r\n            },\r\n            onCancel() {\r\n            },\r\n        });\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.fetchSubmittedRequests(this.requestType)\r\n    }\r\n\r\n    render() {\r\n        let { requestType } = this.props.location.state || {}\r\n        this.requestType = requestType\r\n\r\n        const title = this.requestType === 'global_mobility' ? 'Check Global-International Mobility Proxy Forms' :\r\n            this.requestType === 'domestic_mobility' ? 'Check Domestic Mobility Proxy Forms' :\r\n                'Check Proxy Forms';\r\n\r\n        const submitPathName = this.requestType === 'global_mobility' ? '/dashboard/gi-submit' :\r\n            this.requestType === 'domestic_mobility' ? '/dashboard/do-submit' :\r\n                '/dashbard/xx-submit';\r\n\r\n        const detailPathName = this.requestType === 'global_mobility' ? '/dashboard/gi-request-detail' :\r\n            this.requestType === 'domestic_mobility' ? '/dashboard/do-request-detail' :\r\n                '/dashboard/xx-request-detail';\r\n\r\n        const extra = (<Button type=\"primary\" icon={<PlusOutlined />} onClick={() => this.props.history.push({ pathname: submitPathName, state: { requestType: this.requestType } })}>Add</Button>)\r\n\r\n        return (\r\n            <Card title={title} extra={extra}>\r\n                <Table\r\n                    dataSource={this.state.submittedRequests}\r\n                    bordered\r\n                    pagination={{ defaultPageSize: 4, showQuickJumper: true, current: this.props.pageNum, onChange: (current) => this.props.cachePageNum(current) }}\r\n                    loading={this.state.loading}\r\n                >\r\n                    <Column\r\n                        title=\"File Name\"\r\n                        dataIndex=\"attachmentUrl\"\r\n                        key=\"attachmentUrl\"\r\n                        render={(attachmentUrl, record) => {\r\n                            return <a href={attachmentUrl}>{record.attachmentFileName}</a>\r\n                        }}\r\n                    />\r\n                    <Column title=\"Requester\" dataIndex=\"requester\" key=\"requester\" />\r\n                    <Column title=\"Submit Date\" dataIndex=\"submitDate\" key=\"submitDate\" />\r\n                    <Column title=\"Comment\" dataIndex=\"comment\" key=\"comment\" />\r\n                    <Column\r\n                        title=\"Status\"\r\n                        dataIndex=\"tags\"\r\n                        key=\"tags\"\r\n                        render={tags => (\r\n                            <>\r\n                                {tags.map(tag => {\r\n                                    let color = \"blue\"\r\n                                    return (\r\n                                        <Tag color={color} key={tag}>\r\n                                            {tag}\r\n                                        </Tag>\r\n                                    )\r\n                                })}\r\n                            </>\r\n                        )}\r\n                    />\r\n                    <Column\r\n                        title=\"Action\"\r\n                        key=\"action\"\r\n                        render={(text, record) => (\r\n                            <Space size=\"middle\">\r\n                                <Link to={{ pathname: detailPathName, state: { ...record, requestType: this.requestType } }}>Details</Link>\r\n                                <Button onClick={() => this.deleteRequest(record)} type=\"link\">Delete</Button>\r\n                            </Space>\r\n                        )}\r\n                    />\r\n                </Table>\r\n            </Card>\r\n        )\r\n    }\r\n}\r\n\r\nexport default connect(\r\n    state => ({ pageNum: state.pageNum }),\r\n    { cachePageNum, unCacheUser }\r\n)(withRouter(RequestCheck))\r\n"]},"metadata":{},"sourceType":"module"}